{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "description": "Resource Type definition for AWS::EC2::EC2Fleet",
  "additionalProperties": false,
  "properties": {
    "TargetCapacitySpecification": {
      "$ref": "#/definitions/TargetCapacitySpecificationRequest"
    },
    "OnDemandOptions": {
      "$ref": "#/definitions/OnDemandOptionsRequest"
    },
    "Type": {
      "oneOf": [
        {
          "type": "string",
          "enum": [
            "maintain",
            "request",
            "instant"
          ]
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    },
    "ExcessCapacityTerminationPolicy": {
      "oneOf": [
        {
          "type": "string",
          "enum": [
            "termination",
            "no-termination"
          ]
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    },
    "TagSpecifications": {
      "type": "array",
      "uniqueItems": false,
      "items": {
        "$ref": "#/definitions/TagSpecification"
      }
    },
    "SpotOptions": {
      "$ref": "#/definitions/SpotOptionsRequest"
    },
    "ValidFrom": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    },
    "ReplaceUnhealthyInstances": {
      "type": "boolean"
    },
    "LaunchTemplateConfigs": {
      "type": "array",
      "uniqueItems": false,
      "maxItems": 50,
      "items": {
        "$ref": "#/definitions/FleetLaunchTemplateConfigRequest"
      }
    },
    "FleetId": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    },
    "TerminateInstancesWithExpiration": {
      "type": "boolean"
    },
    "ValidUntil": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    },
    "Context": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    }
  },
  "definitions": {
    "OnDemandOptionsRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "SingleAvailabilityZone": {
          "type": "boolean"
        },
        "AllocationStrategy": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "SingleInstanceType": {
          "type": "boolean"
        },
        "MinTargetCapacity": {
          "type": "integer"
        },
        "MaxTotalPrice": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "CapacityReservationOptions": {
          "$ref": "#/definitions/CapacityReservationOptionsRequest"
        }
      }
    },
    "SpotOptionsRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "MaintenanceStrategies": {
          "$ref": "#/definitions/MaintenanceStrategies"
        },
        "SingleAvailabilityZone": {
          "type": "boolean"
        },
        "AllocationStrategy": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "lowest-price",
                "lowestPrice",
                "diversified",
                "capacityOptimized",
                "capacity-optimized",
                "capacityOptimizedPrioritized",
                "capacity-optimized-prioritized",
                "priceCapacityOptimized",
                "price-capacity-optimized"
              ]
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "SingleInstanceType": {
          "type": "boolean"
        },
        "MinTargetCapacity": {
          "type": "integer"
        },
        "MaxTotalPrice": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "InstanceInterruptionBehavior": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "hibernate",
                "stop",
                "terminate"
              ]
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "InstancePoolsToUseCount": {
          "type": "integer"
        }
      }
    },
    "TargetCapacitySpecificationRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "DefaultTargetCapacityType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "on-demand",
                "spot"
              ]
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "TargetCapacityUnitType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "vcpu",
                "memory-mib",
                "units"
              ]
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "TotalTargetCapacity": {
          "type": "integer"
        },
        "OnDemandTargetCapacity": {
          "type": "integer"
        },
        "SpotTargetCapacity": {
          "type": "integer"
        }
      },
      "required": [
        "TotalTargetCapacity"
      ]
    },
    "FleetLaunchTemplateSpecificationRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "LaunchTemplateName": {
          "oneOf": [
            {
              "type": "string",
              "minLength": 3,
              "maxLength": 128,
              "pattern": "[a-zA-Z0-9\\(\\)\\.\\-/_]+"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "LaunchTemplateId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "Version": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        }
      },
      "required": [
        "Version"
      ]
    },
    "Placement": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "GroupName": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "Tenancy": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "SpreadDomain": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "PartitionNumber": {
          "type": "integer"
        },
        "AvailabilityZone": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "Affinity": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "HostId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "HostResourceGroupArn": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        }
      }
    },
    "FleetLaunchTemplateConfigRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "LaunchTemplateSpecification": {
          "$ref": "#/definitions/FleetLaunchTemplateSpecificationRequest"
        },
        "Overrides": {
          "type": "array",
          "uniqueItems": false,
          "items": {
            "$ref": "#/definitions/FleetLaunchTemplateOverridesRequest"
          }
        }
      }
    },
    "CapacityReservationOptionsRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "UsageStrategy": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "use-capacity-reservations-first"
              ]
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        }
      }
    },
    "FleetLaunchTemplateOverridesRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "WeightedCapacity": {
          "type": "number"
        },
        "Placement": {
          "$ref": "#/definitions/Placement"
        },
        "Priority": {
          "type": "number"
        },
        "AvailabilityZone": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "SubnetId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "InstanceType": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "InstanceRequirements": {
          "$ref": "#/definitions/InstanceRequirementsRequest"
        },
        "MaxPrice": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        }
      }
    },
    "Tag": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Value": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "Key": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        }
      },
      "required": [
        "Value",
        "Key"
      ]
    },
    "TagSpecification": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "ResourceType": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "client-vpn-endpoint",
                "customer-gateway",
                "dedicated-host",
                "dhcp-options",
                "egress-only-internet-gateway",
                "elastic-gpu",
                "elastic-ip",
                "export-image-task",
                "export-instance-task",
                "fleet",
                "fpga-image",
                "host-reservation",
                "image",
                "import-image-task",
                "import-snapshot-task",
                "instance",
                "internet-gateway",
                "key-pair",
                "launch-template",
                "local-gateway-route-table-vpc-association",
                "natgateway",
                "network-acl",
                "network-insights-analysis",
                "network-insights-path",
                "network-interface",
                "placement-group",
                "reserved-instances",
                "route-table",
                "security-group",
                "snapshot",
                "spot-fleet-request",
                "spot-instances-request",
                "subnet",
                "traffic-mirror-filter",
                "traffic-mirror-session",
                "traffic-mirror-target",
                "transit-gateway",
                "transit-gateway-attachment",
                "transit-gateway-connect-peer",
                "transit-gateway-multicast-domain",
                "transit-gateway-route-table",
                "volume",
                "vpc",
                "vpc-flow-log",
                "vpc-peering-connection",
                "vpn-connection",
                "vpn-gateway"
              ]
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "Tags": {
          "type": "array",
          "uniqueItems": false,
          "items": {
            "$ref": "#/definitions/Tag"
          }
        }
      }
    },
    "InstanceRequirementsRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "VCpuCount": {
          "$ref": "#/definitions/VCpuCountRangeRequest"
        },
        "MemoryMiB": {
          "$ref": "#/definitions/MemoryMiBRequest"
        },
        "CpuManufacturers": {
          "type": "array",
          "uniqueItems": false,
          "items": {
            "type": "string",
            "enum": [
              "intel",
              "amd",
              "amazon-web-services"
            ]
          }
        },
        "MemoryGiBPerVCpu": {
          "$ref": "#/definitions/MemoryGiBPerVCpuRequest"
        },
        "AllowedInstanceTypes": {
          "type": "array",
          "uniqueItems": false,
          "items": {
            "type": "string",
            "minLength": 1,
            "maxLength": 30,
            "pattern": "[a-zA-Z0-9\\.\\*]+"
          }
        },
        "ExcludedInstanceTypes": {
          "type": "array",
          "uniqueItems": false,
          "items": {
            "type": "string",
            "minLength": 1,
            "maxLength": 30,
            "pattern": "[a-zA-Z0-9\\.\\*]+"
          }
        },
        "InstanceGenerations": {
          "type": "array",
          "uniqueItems": false,
          "items": {
            "type": "string",
            "enum": [
              "current",
              "previous"
            ]
          }
        },
        "SpotMaxPricePercentageOverLowestPrice": {
          "type": "integer"
        },
        "OnDemandMaxPricePercentageOverLowestPrice": {
          "type": "integer"
        },
        "MaxSpotPriceAsPercentageOfOptimalOnDemandPrice": {
          "type": "integer"
        },
        "BareMetal": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "included",
                "required",
                "excluded"
              ]
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "BurstablePerformance": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "included",
                "required",
                "excluded"
              ]
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "RequireHibernateSupport": {
          "type": "boolean"
        },
        "NetworkBandwidthGbps": {
          "$ref": "#/definitions/NetworkBandwidthGbpsRequest"
        },
        "NetworkInterfaceCount": {
          "$ref": "#/definitions/NetworkInterfaceCountRequest"
        },
        "LocalStorage": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "included",
                "required",
                "excluded"
              ]
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "LocalStorageTypes": {
          "type": "array",
          "uniqueItems": false,
          "items": {
            "type": "string",
            "enum": [
              "hdd",
              "ssd"
            ]
          }
        },
        "TotalLocalStorageGB": {
          "$ref": "#/definitions/TotalLocalStorageGBRequest"
        },
        "BaselineEbsBandwidthMbps": {
          "$ref": "#/definitions/BaselineEbsBandwidthMbpsRequest"
        },
        "AcceleratorTypes": {
          "type": "array",
          "uniqueItems": false,
          "items": {
            "type": "string",
            "enum": [
              "gpu",
              "fpga",
              "inference"
            ]
          }
        },
        "AcceleratorCount": {
          "$ref": "#/definitions/AcceleratorCountRequest"
        },
        "AcceleratorManufacturers": {
          "type": "array",
          "uniqueItems": false,
          "items": {
            "type": "string",
            "enum": [
              "amazon-web-services",
              "amd",
              "habana",
              "nvidia",
              "xilinx"
            ]
          }
        },
        "AcceleratorNames": {
          "type": "array",
          "uniqueItems": false,
          "items": {
            "type": "string",
            "enum": [
              "a10g",
              "a100",
              "h100",
              "inferentia",
              "k520",
              "k80",
              "m60",
              "radeon-pro-v520",
              "t4",
              "t4g",
              "vu9p",
              "v100"
            ]
          }
        },
        "AcceleratorTotalMemoryMiB": {
          "$ref": "#/definitions/AcceleratorTotalMemoryMiBRequest"
        }
      }
    },
    "VCpuCountRangeRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Min": {
          "type": "integer"
        },
        "Max": {
          "type": "integer"
        }
      }
    },
    "MemoryMiBRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Min": {
          "type": "integer"
        },
        "Max": {
          "type": "integer"
        }
      }
    },
    "MemoryGiBPerVCpuRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Min": {
          "type": "number"
        },
        "Max": {
          "type": "number"
        }
      }
    },
    "NetworkBandwidthGbpsRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Min": {
          "type": "number"
        },
        "Max": {
          "type": "number"
        }
      }
    },
    "NetworkInterfaceCountRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Min": {
          "type": "integer"
        },
        "Max": {
          "type": "integer"
        }
      }
    },
    "TotalLocalStorageGBRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Min": {
          "type": "number"
        },
        "Max": {
          "type": "number"
        }
      }
    },
    "BaselineEbsBandwidthMbpsRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Min": {
          "type": "integer"
        },
        "Max": {
          "type": "integer"
        }
      }
    },
    "AcceleratorCountRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Min": {
          "type": "integer"
        },
        "Max": {
          "type": "integer"
        }
      }
    },
    "AcceleratorTotalMemoryMiBRequest": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Min": {
          "type": "integer"
        },
        "Max": {
          "type": "integer"
        }
      }
    },
    "MaintenanceStrategies": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "CapacityRebalance": {
          "$ref": "#/definitions/CapacityRebalance"
        }
      }
    },
    "CapacityRebalance": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "ReplacementStrategy": {
          "oneOf": [
            {
              "type": "string",
              "enum": [
                "launch",
                "launch-before-terminate"
              ]
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "TerminationDelay": {
          "type": "integer"
        }
      }
    }
  },
  "required": [
    "TargetCapacitySpecification",
    "LaunchTemplateConfigs"
  ]
}