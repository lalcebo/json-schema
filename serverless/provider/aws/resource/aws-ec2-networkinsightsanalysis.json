{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "type": "object",
  "description": "Resource schema for AWS::EC2::NetworkInsightsAnalysis",
  "additionalIdentifiers": [
    [
      "/properties/NetworkInsightsAnalysisArn"
    ]
  ],
  "additionalProperties": false,
  "definitions": {
    "PathComponent": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "AdditionalDetails": {
          "uniqueItems": false,
          "insertionOrder": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/AdditionalDetail"
          }
        },
        "InboundHeader": {
          "$ref": "#/definitions/AnalysisPacketHeader"
        },
        "Vpc": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "DestinationVpc": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "SecurityGroupRule": {
          "$ref": "#/definitions/AnalysisSecurityGroupRule"
        },
        "TransitGateway": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "ElasticLoadBalancerListener": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Explanations": {
          "uniqueItems": false,
          "insertionOrder": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/Explanation"
          }
        },
        "ServiceName": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "SequenceNumber": {
          "type": "integer"
        },
        "SourceVpc": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "OutboundHeader": {
          "$ref": "#/definitions/AnalysisPacketHeader"
        },
        "AclRule": {
          "$ref": "#/definitions/AnalysisAclRule"
        },
        "TransitGatewayRouteTableRoute": {
          "$ref": "#/definitions/TransitGatewayRouteTableRoute"
        },
        "Component": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Subnet": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "RouteTableRoute": {
          "$ref": "#/definitions/AnalysisRouteTableRoute"
        }
      }
    },
    "AnalysisLoadBalancerListener": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "InstancePort": {
          "$ref": "#/definitions/Port"
        },
        "LoadBalancerPort": {
          "$ref": "#/definitions/Port"
        }
      }
    },
    "AnalysisLoadBalancerTarget": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "Address": {
          "$ref": "#/definitions/IpAddress"
        },
        "Instance": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Port": {
          "$ref": "#/definitions/Port"
        },
        "AvailabilityZone": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        }
      }
    },
    "Explanation": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "VpnGateway": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "PacketField": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "TransitGatewayAttachment": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Protocols": {
          "uniqueItems": false,
          "insertionOrder": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/Protocol"
          }
        },
        "IngressRouteTable": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "ClassicLoadBalancerListener": {
          "$ref": "#/definitions/AnalysisLoadBalancerListener"
        },
        "VpcPeeringConnection": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Address": {
          "$ref": "#/definitions/IpAddress"
        },
        "Port": {
          "$ref": "#/definitions/Port"
        },
        "Addresses": {
          "uniqueItems": false,
          "insertionOrder": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/IpAddress"
          }
        },
        "ElasticLoadBalancerListener": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "TransitGatewayRouteTable": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "ExplanationCode": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "InternetGateway": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "SourceVpc": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "AttachedTo": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "PrefixList": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "TransitGatewayRouteTableRoute": {
          "$ref": "#/definitions/TransitGatewayRouteTableRoute"
        },
        "ComponentRegion": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "LoadBalancerTargetGroup": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "NetworkInterface": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "CustomerGateway": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "DestinationVpc": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "SecurityGroup": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "TransitGateway": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "RouteTable": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "State": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "LoadBalancerListenerPort": {
          "$ref": "#/definitions/Port"
        },
        "vpcEndpoint": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Subnet": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Cidrs": {
          "uniqueItems": false,
          "insertionOrder": true,
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "Destination": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "SecurityGroups": {
          "uniqueItems": false,
          "insertionOrder": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/AnalysisComponent"
          }
        },
        "ComponentAccount": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "VpnConnection": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Vpc": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "NatGateway": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Direction": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "LoadBalancerTargetPort": {
          "$ref": "#/definitions/Port"
        },
        "LoadBalancerTarget": {
          "$ref": "#/definitions/AnalysisLoadBalancerTarget"
        },
        "LoadBalancerTargetGroups": {
          "uniqueItems": false,
          "insertionOrder": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/AnalysisComponent"
          }
        },
        "Component": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "MissingComponent": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "RouteTableRoute": {
          "$ref": "#/definitions/AnalysisRouteTableRoute"
        },
        "AvailabilityZones": {
          "uniqueItems": false,
          "insertionOrder": true,
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "PortRanges": {
          "uniqueItems": false,
          "insertionOrder": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/PortRange"
          }
        },
        "Acl": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "SecurityGroupRule": {
          "$ref": "#/definitions/AnalysisSecurityGroupRule"
        },
        "SubnetRouteTable": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "LoadBalancerArn": {
          "$ref": "#/definitions/ResourceArn"
        },
        "AclRule": {
          "$ref": "#/definitions/AnalysisAclRule"
        }
      }
    },
    "Port": {
      "type": "integer"
    },
    "AnalysisPacketHeader": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "DestinationPortRanges": {
          "uniqueItems": false,
          "insertionOrder": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/PortRange"
          }
        },
        "SourcePortRanges": {
          "uniqueItems": false,
          "insertionOrder": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/PortRange"
          }
        },
        "DestinationAddresses": {
          "uniqueItems": false,
          "insertionOrder": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/IpAddress"
          }
        },
        "Protocol": {
          "$ref": "#/definitions/Protocol"
        },
        "SourceAddresses": {
          "uniqueItems": false,
          "insertionOrder": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/IpAddress"
          }
        }
      }
    },
    "AdditionalDetail": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "ServiceName": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "AdditionalDetailType": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "LoadBalancers": {
          "uniqueItems": false,
          "insertionOrder": true,
          "type": "array",
          "items": {
            "$ref": "#/definitions/AnalysisComponent"
          }
        },
        "Component": {
          "$ref": "#/definitions/AnalysisComponent"
        }
      }
    },
    "AlternatePathHint": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "ComponentArn": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "ComponentId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        }
      }
    },
    "TransitGatewayRouteTableRoute": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "PrefixListId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "ResourceId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "State": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "ResourceType": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "RouteOrigin": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "DestinationCidr": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "AttachmentId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        }
      }
    },
    "Protocol": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    },
    "Tags": {
      "uniqueItems": true,
      "type": "array",
      "items": {
        "$ref": "#/definitions/Tag"
      }
    },
    "AnalysisSecurityGroupRule": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "PortRange": {
          "$ref": "#/definitions/PortRange"
        },
        "Cidr": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "PrefixListId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "SecurityGroupId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "Protocol": {
          "$ref": "#/definitions/Protocol"
        },
        "Direction": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        }
      }
    },
    "AnalysisComponent": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "Id": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "Arn": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        }
      }
    },
    "AnalysisAclRule": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "PortRange": {
          "$ref": "#/definitions/PortRange"
        },
        "Cidr": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "RuleAction": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "Egress": {
          "type": "boolean"
        },
        "RuleNumber": {
          "type": "integer"
        },
        "Protocol": {
          "$ref": "#/definitions/Protocol"
        }
      }
    },
    "AnalysisRouteTableRoute": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "Origin": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "destinationPrefixListId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "destinationCidr": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "NetworkInterfaceId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "TransitGatewayId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "VpcPeeringConnectionId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "instanceId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "State": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "egressOnlyInternetGatewayId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "NatGatewayId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "gatewayId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        }
      }
    },
    "ResourceArn": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    },
    "PortRange": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "From": {
          "type": "integer"
        },
        "To": {
          "type": "integer"
        }
      }
    },
    "IpAddress": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    },
    "Tag": {
      "additionalProperties": false,
      "type": "object",
      "properties": {
        "Value": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        },
        "Key": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../component/functions.json#/AwsFunctionString"
            }
          ]
        }
      },
      "required": [
        "Key"
      ]
    }
  },
  "required": [
    "NetworkInsightsPathId"
  ],
  "properties": {
    "Status": {
      "oneOf": [
        {
          "type": "string",
          "enum": [
            "running",
            "failed",
            "succeeded"
          ]
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    },
    "ReturnPathComponents": {
      "uniqueItems": false,
      "insertionOrder": true,
      "type": "array",
      "items": {
        "$ref": "#/definitions/PathComponent"
      }
    },
    "NetworkInsightsAnalysisId": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    },
    "NetworkInsightsPathId": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    },
    "NetworkPathFound": {
      "type": "boolean"
    },
    "SuggestedAccounts": {
      "uniqueItems": true,
      "insertionOrder": true,
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "FilterInArns": {
      "uniqueItems": false,
      "insertionOrder": true,
      "type": "array",
      "items": {
        "$ref": "#/definitions/ResourceArn"
      }
    },
    "NetworkInsightsAnalysisArn": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    },
    "StatusMessage": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    },
    "StartDate": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../component/functions.json#/AwsFunctionString"
        }
      ]
    },
    "AlternatePathHints": {
      "uniqueItems": false,
      "insertionOrder": true,
      "type": "array",
      "items": {
        "$ref": "#/definitions/AlternatePathHint"
      }
    },
    "Explanations": {
      "uniqueItems": false,
      "insertionOrder": true,
      "type": "array",
      "items": {
        "$ref": "#/definitions/Explanation"
      }
    },
    "ForwardPathComponents": {
      "uniqueItems": false,
      "insertionOrder": true,
      "type": "array",
      "items": {
        "$ref": "#/definitions/PathComponent"
      }
    },
    "AdditionalAccounts": {
      "uniqueItems": true,
      "insertionOrder": true,
      "type": "array",
      "items": {
        "type": "string"
      }
    },
    "Tags": {
      "uniqueItems": true,
      "type": "array",
      "items": {
        "$ref": "#/definitions/Tag"
      }
    }
  }
}