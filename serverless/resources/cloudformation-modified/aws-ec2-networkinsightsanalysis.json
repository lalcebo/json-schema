{
  "typeName": "AWS::EC2::NetworkInsightsAnalysis",
  "description": "Resource schema for AWS::EC2::NetworkInsightsAnalysis. Source:- https://github.com/aws-cloudformation/aws-cloudformation-resource-providers-ec2-ni.git",
  "sourceUrl": "https://github.com/aws-cloudformation/aws-cloudformation-resource-providers-ec2-ni.git",
  "definitions": {
    "Tags": {
      "type": "array",
      "uniqueItems": true,
      "items": {
        "$ref": "#/definitions/Tag"
      }
    },
    "Tag": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Key": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "Value": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        }
      },
      "required": [
        "Key"
      ]
    },
    "ResourceArn": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
        }
      ]
    },
    "PortRange": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "From": {
          "type": "integer"
        },
        "To": {
          "type": "integer"
        }
      }
    },
    "Protocol": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
        }
      ]
    },
    "AnalysisAclRule": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Cidr": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "Egress": {
          "type": "boolean"
        },
        "PortRange": {
          "$ref": "#/definitions/PortRange"
        },
        "Protocol": {
          "$ref": "#/definitions/Protocol"
        },
        "RuleAction": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "RuleNumber": {
          "type": "integer"
        }
      }
    },
    "AnalysisPacketHeader": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "DestinationAddresses": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/IpAddress"
          }
        },
        "DestinationPortRanges": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/PortRange"
          }
        },
        "Protocol": {
          "$ref": "#/definitions/Protocol"
        },
        "SourceAddresses": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/IpAddress"
          }
        },
        "SourcePortRanges": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/PortRange"
          }
        }
      }
    },
    "PathComponent": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "SequenceNumber": {
          "type": "integer"
        },
        "AclRule": {
          "$ref": "#/definitions/AnalysisAclRule"
        },
        "AdditionalDetails": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/AdditionalDetail"
          }
        },
        "Component": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "DestinationVpc": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Explanations": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Explanation"
          }
        },
        "ElasticLoadBalancerListener": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "OutboundHeader": {
          "$ref": "#/definitions/AnalysisPacketHeader"
        },
        "InboundHeader": {
          "$ref": "#/definitions/AnalysisPacketHeader"
        },
        "RouteTableRoute": {
          "$ref": "#/definitions/AnalysisRouteTableRoute"
        },
        "SecurityGroupRule": {
          "$ref": "#/definitions/AnalysisSecurityGroupRule"
        },
        "SourceVpc": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Subnet": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Vpc": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "TransitGateway": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "TransitGatewayRouteTableRoute": {
          "$ref": "#/definitions/TransitGatewayRouteTableRoute"
        }
      }
    },
    "AnalysisComponent": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Id": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "Arn": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        }
      }
    },
    "IpAddress": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
        }
      ]
    },
    "AnalysisLoadBalancerListener": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "InstancePort": {
          "$ref": "#/definitions/Port"
        },
        "LoadBalancerPort": {
          "$ref": "#/definitions/Port"
        }
      }
    },
    "AnalysisLoadBalancerTarget": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Address": {
          "$ref": "#/definitions/IpAddress"
        },
        "AvailabilityZone": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "Instance": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Port": {
          "$ref": "#/definitions/Port"
        }
      }
    },
    "Port": {
      "type": "integer"
    },
    "AnalysisRouteTableRoute": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "destinationCidr": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "destinationPrefixListId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "egressOnlyInternetGatewayId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "gatewayId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "instanceId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "NatGatewayId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "NetworkInterfaceId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "Origin": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "State": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "TransitGatewayId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "VpcPeeringConnectionId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        }
      }
    },
    "AnalysisSecurityGroupRule": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Cidr": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "Direction": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "SecurityGroupId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "PortRange": {
          "$ref": "#/definitions/PortRange"
        },
        "PrefixListId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "Protocol": {
          "$ref": "#/definitions/Protocol"
        }
      }
    },
    "TransitGatewayRouteTableRoute": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "DestinationCidr": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "State": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "RouteOrigin": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "PrefixListId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "AttachmentId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "ResourceId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "ResourceType": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        }
      }
    },
    "AdditionalDetail": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "AdditionalDetailType": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "Component": {
          "$ref": "#/definitions/AnalysisComponent"
        }
      }
    },
    "Explanation": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "Acl": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "AclRule": {
          "$ref": "#/definitions/AnalysisAclRule"
        },
        "Address": {
          "$ref": "#/definitions/IpAddress"
        },
        "Addresses": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/IpAddress"
          }
        },
        "AttachedTo": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "AvailabilityZones": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "Cidrs": {
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "Component": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "ComponentAccount": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "ComponentRegion": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "CustomerGateway": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Destination": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "DestinationVpc": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Direction": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "ExplanationCode": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "IngressRouteTable": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "InternetGateway": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "LoadBalancerArn": {
          "$ref": "#/definitions/ResourceArn"
        },
        "ClassicLoadBalancerListener": {
          "$ref": "#/definitions/AnalysisLoadBalancerListener"
        },
        "LoadBalancerListenerPort": {
          "$ref": "#/definitions/Port"
        },
        "LoadBalancerTarget": {
          "$ref": "#/definitions/AnalysisLoadBalancerTarget"
        },
        "LoadBalancerTargetGroup": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "LoadBalancerTargetGroups": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/AnalysisComponent"
          }
        },
        "LoadBalancerTargetPort": {
          "$ref": "#/definitions/Port"
        },
        "ElasticLoadBalancerListener": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "MissingComponent": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "NatGateway": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "NetworkInterface": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "PacketField": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "VpcPeeringConnection": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Port": {
          "$ref": "#/definitions/Port"
        },
        "PortRanges": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/PortRange"
          }
        },
        "PrefixList": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Protocols": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Protocol"
          }
        },
        "RouteTableRoute": {
          "$ref": "#/definitions/AnalysisRouteTableRoute"
        },
        "RouteTable": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "SecurityGroup": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "SecurityGroupRule": {
          "$ref": "#/definitions/AnalysisSecurityGroupRule"
        },
        "SecurityGroups": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/AnalysisComponent"
          }
        },
        "SourceVpc": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "State": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "Subnet": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "SubnetRouteTable": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "Vpc": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "vpcEndpoint": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "VpnConnection": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "VpnGateway": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "TransitGateway": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "TransitGatewayAttachment": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "TransitGatewayRouteTable": {
          "$ref": "#/definitions/AnalysisComponent"
        },
        "TransitGatewayRouteTableRoute": {
          "$ref": "#/definitions/TransitGatewayRouteTableRoute"
        }
      }
    },
    "AlternatePathHint": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "ComponentId": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        },
        "ComponentArn": {
          "oneOf": [
            {
              "type": "string"
            },
            {
              "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
            }
          ]
        }
      }
    }
  },
  "properties": {
    "AdditionalAccounts": {
      "type": "array",
      "insertionOrder": true,
      "uniqueItems": true,
      "items": {
        "type": "string"
      }
    },
    "NetworkInsightsPathId": {
      "oneOf": [
        {
          "type": "string"
        },
        {
          "$ref": "../../components/cf.functions.json#/Aws_CF_FunctionString"
        }
      ]
    },
    "FilterInArns": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/ResourceArn"
      }
    },
    "Tags": {
      "type": "array",
      "items": {
        "$ref": "#/definitions/Tag"
      }
    }
  },
  "additionalProperties": false,
  "required": [
    "NetworkInsightsPathId"
  ],
  "readOnlyProperties": [
    "/properties/NetworkInsightsAnalysisId",
    "/properties/NetworkInsightsAnalysisArn",
    "/properties/StartDate",
    "/properties/Status",
    "/properties/StatusMessage",
    "/properties/ErrorCode",
    "/properties/ErrorMessage",
    "/properties/NetworkPathFound",
    "/properties/ForwardPathComponents",
    "/properties/ReturnPathComponents",
    "/properties/Explanations",
    "/properties/AlternatePathHints",
    "/properties/SuggestedAccounts"
  ],
  "primaryIdentifier": [
    "/properties/NetworkInsightsAnalysisId"
  ],
  "createOnlyProperties": [
    "/properties/NetworkInsightsPathId",
    "/properties/FilterInArns"
  ],
  "additionalIdentifiers": [
    [
      "/properties/NetworkInsightsAnalysisArn"
    ]
  ],
  "handlers": {
    "create": {
      "permissions": [
        "ec2:StartNetworkInsightsAnalysis",
        "ec2:GetTransitGatewayRouteTablePropagations",
        "ec2:SearchTransitGatewayRoutes",
        "ec2:Describe*",
        "ec2:GetManagedPrefixListEntries",
        "elasticloadbalancing:Describe*",
        "directconnect:Describe*",
        "tiros:CreateQuery",
        "tiros:GetQueryAnswer",
        "tiros:GetQueryExplanation"
      ]
    },
    "delete": {
      "permissions": [
        "ec2:DeleteNetworkInsightsAnalysis"
      ]
    },
    "read": {
      "permissions": [
        "ec2:Describe*"
      ]
    },
    "list": {
      "permissions": [
        "ec2:Describe*"
      ]
    },
    "update": {
      "permissions": [
        "ec2:CreateTags",
        "ec2:Describe*",
        "ec2:DeleteTags"
      ]
    }
  },
  "title": "AWS::EC2::NetworkInsightsAnalysis",
  "type": "object"
}